{% extends "base.html" %}

{% block title %}Rafflr - Win Amazing Products{% endblock %}

{% block content %}
<div class="bg-gradient-to-r from-primary to-purple-600 text-white">
    <div class="max-w-7xl mx-auto py-16 px-4 sm:py-24 sm:px-6 lg:px-8">
        <div class="text-center">
            <h1 class="text-4xl font-extrabold sm:text-5xl md:text-6xl">
                Win Amazing Products
            </h1>
            <p class="mt-6 max-w-2xl mx-auto text-xl text-gray-100">
                Purchase raffle tickets for a chance to win products at a fraction of their retail price.
            </p>
            <div class="mt-10 flex justify-center gap-4">
                <a href="/listings" class="bg-white text-primary px-8 py-3 rounded-md font-semibold hover:bg-gray-100">
                    Browse Raffles
                </a>
                {% if not user %}
                <a href="/auth/register" class="border-2 border-white text-white px-8 py-3 rounded-md font-semibold hover:bg-white hover:text-primary">
                    Sign Up
                </a>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-8">Featured Raffles</h2>

    {% if featured_listings %}
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for listing in featured_listings %}
        <a href="/listings/{{ listing.id }}" class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow">
            {% if listing.image_url %}
            <img src="{{ listing.image_url }}" alt="{{ listing.title }}" class="w-full h-48 object-cover">
            {% else %}
            <div class="w-full h-48 bg-gray-200 flex items-center justify-center">
                <span class="text-gray-400">No image</span>
            </div>
            {% endif %}
            <div class="p-4">
                <h3 class="font-semibold text-lg text-gray-900">{{ listing.title }}</h3>
                <div class="mt-2 flex justify-between items-center">
                    <span class="text-primary font-bold">${{ "%.2f"|format(listing.ticket_price) }} / ticket</span>
                    <span class="text-sm text-gray-500">{{ listing.tickets_sold }} / {{ listing.max_tickets }} sold</span>
                </div>
                <div class="mt-2">
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="bg-primary rounded-full h-2" style="width: {{ (listing.tickets_sold / listing.max_tickets * 100)|int }}%"></div>
                    </div>
                </div>
                {% if listing.deadline %}
                <p class="mt-2 text-sm text-gray-500">Ends: {{ listing.deadline.strftime('%b %d, %Y %I:%M %p') }}</p>
                {% endif %}
            </div>
        </a>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-12">
        <p class="text-gray-500">No active raffles at the moment.</p>
        {% if user %}
        <a href="/listings/create" class="mt-4 inline-block text-primary hover:underline">Create the first one!</a>
        {% endif %}
    </div>
    {% endif %}
</div>

<div class="bg-gray-100 py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <h2 class="text-2xl font-bold text-gray-900 text-center mb-12">How It Works</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="text-center">
                <div class="w-16 h-16 bg-primary text-white rounded-full flex items-center justify-center mx-auto text-2xl font-bold">1</div>
                <h3 class="mt-4 text-lg font-semibold">Browse Raffles</h3>
                <p class="mt-2 text-gray-600">Find products you'd love to win at amazing prices.</p>
            </div>
            <div class="text-center">
                <div class="w-16 h-16 bg-primary text-white rounded-full flex items-center justify-center mx-auto text-2xl font-bold">2</div>
                <h3 class="mt-4 text-lg font-semibold">Buy Tickets</h3>
                <p class="mt-2 text-gray-600">Purchase raffle tickets. More tickets = higher chance to win!</p>
            </div>
            <div class="text-center">
                <div class="w-16 h-16 bg-primary text-white rounded-full flex items-center justify-center mx-auto text-2xl font-bold">3</div>
                <h3 class="mt-4 text-lg font-semibold">Win!</h3>
                <p class="mt-2 text-gray-600">Winners are drawn automatically when conditions are met.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
